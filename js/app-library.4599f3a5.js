(self["webpackChunk_cjmia_dashboard"]=self["webpackChunk_cjmia_dashboard"]||[]).push([[891],{3833:function(t,e,s){"use strict";s.r(e);s(3426),s(4246),s(9769),s(5613);const i=s(5801),n={};i.keys().forEach((t=>{"./index.js"!==t&&(n[t.toLowerCase().replace(/(\.\/|\.js)/g,"")]=i(t).default)})),e["default"]=n},213:function(t,e,s){"use strict";s.r(e);s(4936);var i=s(7348),n=s.n(i);(function(t){var e=1,s=2,i=3,o=4,a=1,h=2,r="span",c="div",l=1,d=1,u=null;function f(){}function g(t,e,s,i,n){this.spaceType=t,this.width=e,this.height=s,this.x=i,this.y=n}function p(t){this.code=t.code,this.word=t.word,this.weight=t.weight,this.fontFactor=t.fontFactor,this.fontOffset=t.fontOffset,this.minWeight=t.minWeight,this.padding_left=t.padding_left,this.font_family=t.font_family,this.font=null,this.color=t.color,this.span=null,this.width=null,this.height=null,this.word_class=t.word_class,this.legend=!!t.legend&&t.legend,this._init()}function m(){this.defaultOptions={title:"JQ WOrd Cloud",words:[],minFont:10,maxFont:50,fontOffset:0,showSpaceDIV:!1,verticalEnabled:!0,cloud_color:null,cloud_font_family:null,spaceDIVColor:"white",padding_left:null,word_common_classes:null,word_click:function(){},word_mouseOver:function(){},word_mouseEnter:function(){},word_mouseOut:function(){},beforeCloudRender:function(){},afterCloudRender:function(){}},this.minWeight=null,this.maxWeight=null,this.spaceDataObject=null,this.spaceIdArray=null,this.words=null,this.fontFactor=1,this.methods={destroy:this._destroy}}f.getRandomColor=function(){for(var t="0123456789ABCDEF".split(""),e="#",s=0;s<6;s++)e+=t[Math.round(15*Math.random())];return e},p.prototype={_init:function(){this._setFont(),this._setSpan_Size()},_setFont:function(){this.font=Math.floor((this.weight-this.minWeight)*this.fontFactor+this.fontOffset)},_setSpan_Size:function(){var e,s=document.createElement(r);s.setAttribute("id","Word_"+d+++"_"+this.weight),document.body.appendChild(s),t(s).css({position:"absolute",display:"block",left:-999990,top:0}),t(s).css("font-size",this.font+"px"),null!=this.word_class&&""!=this.word_class&&t(s).addClass(this.word_class),e=null!=this.color&&""!=this.color?this.color:"#666666",t(s).attr("data-bubble-id",u.id+"_"+this.code),t(s).attr("data-code",this.code),t(s).css("color",e),t(s).css("-webkit-user-select","none").css("-moz-user-select","none").css("-ms-user-select","none"),t(s).css("user-select","none").css("-o-user-select","none"),t(s).css("line-height",this.font+"px"),null==this.padding_left&&(this.padding_left=0),t(s).html("<span class='bg' style='border-color:"+e+";background:"+e+"CC'></span><span>"+this.word+"</span>"),this.width=t(s).outerWidth()+6,this.height=t(s).outerHeight()+6,t(s).remove(),this.span=s}},m.prototype={_init:function(e){if(l=1,d=1,u=e,null!=e&&"string"===typeof e)return null!=this.methods[e]?this.methods[e].apply():null;null==e?this.options=this.defaultOptions:null!=e&&"object"===typeof e&&(this.options=t.extend(this.defaultOptions,e)),this.spaceDataObject={},this.spaceIdArray=[],this.words=this.options.words,this.words.sort((function(t,e){return t.weight<e.weight?1:t.weight>e.weight?-1:0})),this.options.beforeCloudRender(),this._start(),this.options.afterCloudRender(),this._final()},_setFontFactor:function(){this.maxWeight=this.words[0].weight,this.minWeight=this.words[this.words.length-1].weight,this.fontFactor=(this.options.maxFont-this.options.minFont)/(this.maxWeight-this.minWeight)},_start:function(){this._destroy(),this._setFontFactor(),this._draw()},_final:function(){},_destroy:function(){this.$target.html("")},_setTarget:function(t){this.$target=t,t.css("position","relative"),this.tWidth=t.innerWidth(),this.xOffset=this.tWidth/2,this.tHeight=t.innerHeight(),this.yOffset=this.tHeight/2},_draw:function(){var e=this;this.words.filter((function(s,i){var n=s,o={};o["code"]=n.code,o["word"]=n.word,o["weight"]=n.weight,null!=e.options.cloud_color?o["color"]=e.options.cloud_color:o["color"]=n.color,null!=e.options.padding_left&&(o["padding_left"]=e.options.padding_left),o["word_class"]=n.word_class,null!=e.options.cloud_font_family?o["font_family"]=e.options.cloud_font_family:o["font_family"]=n.font_family,o["fontFactor"]=e.fontFactor,o["fontOffset"]=e.options.fontOffset+e.options.minFont,o["minWeight"]=e.minWeight;var a=new p(o);null!=e.options.word_common_classes&&t(a.span).addClass(e.options.word_common_classes);JSON.parse(JSON.stringify(e.words[i]));t(a.span).on("click",(function(){e.options.word_click(n)})),t(a.span).on("mouseover",(function(t){e.options.word_mouseOver(t,n)})),t(a.span).on("mouseout",(function(t){e.options.word_mouseOut(t,n)})),t(a.span).on("mouseenter",e.options.word_mouseEnter),0==i?e._placeFirstWord(a):e._placeOtherWord(a)}))},_updateSpaceIdArray:function(t,e){if(0!=this.spaceIdArray.length){for(var s=0;s<this.spaceIdArray.length;s++)if(e<parseFloat(this.spaceIdArray[s].split("_")[0]))return void this.spaceIdArray.splice(s,0,t);this.spaceIdArray.push(t)}else this.spaceIdArray.push(t)},_showSpaceDiv:function(n,a,h,r,l){var d=1,u=1;switch(n){case e:d=0,u=-1;break;case s:d=0,u=0;break;case i:d=-1,u=0;break;case o:d=-1,u=-1;break}var f=document.createElement(c);t(f).css("left",parseInt(r+d*a)).css("top",parseInt(l+u*h)).css("width",a).css("height",h).css("border","1px "+this.options.spaceDIVColor+" solid").css("position","absolute").css("display","block"),this.$target.append(f)},_pushSpaceData:function(t,e,s,i,n){var o=Math.sqrt((this.xOffset-i)*(this.xOffset-i)+(this.yOffset-n)*(this.yOffset-n)),a=o+"_"+l++;this._updateSpaceIdArray(a,o),this.spaceDataObject[a]=new g(t,e,s,i,n),this.options.showSpaceDIV&&this._showSpaceDiv(t,e,s,i,n)},_placeFirstWord:function(n){var a=n.width,h=n.height,r=this.xOffset-a/2,c=this.yOffset-h/2,l=this.tWidth,d=this.tHeight,u=n.span;t(u).css("left",r).css("top",c).css("display","inline"),this.$target.append(u),this._pushSpaceData(e,l-r-a,h,r+a,c+h/2),this._pushSpaceData(s,a,d-c-h,r+a/2,c+h),this._pushSpaceData(i,r,h,r,c+h/2),this._pushSpaceData(o,a,c,r+a/2,c),this._pushSpaceData(s,a/2,h/2,r+a,c+h/2),this._pushSpaceData(i,a/2,h/2,r+a/2,c+h),this._pushSpaceData(o,a/2,h/2,r,c+h/2),this._pushSpaceData(e,a/2,h/2,r+a/2,c),this._pushSpaceData(s,l-r-a-a/2,d-c-h/2,r+a+a/2,c+h/2),this._pushSpaceData(i,r+a/2,d-c-h-h/2,r+a/2,c+h+h/2),this._pushSpaceData(o,r-a/2,c+h/2,r-a/2,c+h/2),this._pushSpaceData(e,r+a/2,c-h/2,r+a/2,c-h/2)},_placeOtherWord:function(r){for(var c=0;c<this.spaceIdArray.length;c++){var l=this.spaceIdArray[c],d=this.spaceDataObject[l],u=0,f=0;if(r.width<=d.width&&r.height<=d.height&&(u=a,f++),this.options.verticalEnabled&&r.height<=d.width&&r.width<=d.height&&(u=h,f++),f>0){this.spaceDataObject[l]=null,this.spaceIdArray.splice(c,1);var g=1,p=1,m=1,y=1;switch(d.spaceType){case e:g=0,p=-1,m=1,y=-1;break;case s:g=0,p=0,m=1,y=1;break;case i:g=-1,p=0,m=-1,y=1;break;case o:g=-1,p=-1,m=-1,y=-1;break}f>1&&(u=5*Math.random()>3?h:a);var v=r.width,b=r.height;switch(u){case a:var _=r.span;t(_).css("left",d.x+g*v).css("top",d.y+p*b).css("display","inline"),this.$target.append(_),2*Math.random()>1?(this._pushSpaceData(d.spaceType,d.width-v,b,d.x+m*v,d.y),this._pushSpaceData(d.spaceType,d.width,d.height-b,d.x,d.y+y*b)):(this._pushSpaceData(d.spaceType,d.width-v,d.height,d.x+m*v,d.y),this._pushSpaceData(d.spaceType,v,d.height-b,d.x,d.y+y*b));break;case h:_=r.span;n().browser&&n().browser.msie?t(_).css("left",d.x+g*b).css("top",d.y+p*v):t(_).css("left",d.x+g*b-(v-b)/2).css("top",d.y+p*v+(v-b)/2),t(_).css("display","block").css("-webkit-transform","rotate(270deg)").css("-moz-transform","rotate(270deg)"),t(_).css("-o-transform","rotate(270deg)").css("filter","progid:DXImageTransform.Microsoft.BasicImage(rotation=3)"),this.$target.append(_),2*Math.random()>1?(this._pushSpaceData(d.spaceType,d.width-b,v,d.x+m*b,d.y),this._pushSpaceData(d.spaceType,d.width,d.height-v,d.x,d.y+y*v)):(this._pushSpaceData(d.spaceType,d.width-b,d.height,d.x+m*b,d.y),this._pushSpaceData(d.spaceType,b,d.height-v,d.x,d.y+y*v));break}return}}}},t.fn.jQWCloud=function(e){var s=new m;s._setTarget(t(this)),t.data(this,"jqw_cloud",s),s._init(e)}})(n())},3818:function(t,e,s){"use strict";s.r(e);var i=s(7348),n=s.n(i);(function(t){var e=!1;function s(t,e,s,i,n){this.x=t,this.y=e,this.width=s,this.height=i,this.margin=n}function i(i,n){void 0!=n.click&&(e=!0),n=n||{},this.$div=i,i.css("position","relative"),this.rectangle=new s(0,0,i.width(),i.height(),0),this.nodeClass=function(){return""},this.click=function(){},this.mouseenter=function(){},this.mouseleave=function(){},this.mousemove=function(){},this.paintCallback=function(){},this.ready=function(){},this.itemMargin=0,this.smallestFontSize=15,this.startingFontSize=24,this.centerLabelVertically=!0,t.extend(this,n),this.setNodeColors=function(t,e){this.backgroundColor&&t.css("background-color",this.backgroundColor(t,e)),this.color&&t.css("color",this.color(t,e))}}s.prototype.style=function(){return{top:this.y+"px",left:this.x+"px",width:this.width-this.margin+"px",height:this.height-this.margin+"px"}},s.prototype.isWide=function(){return this.width>this.height},i.SIDE_MARGIN=20,i.TOP_MARGIN=20,i.prototype.paint=function(s){s=this.squarify(s,this.rectangle),this.$div.children().length>0&&this.$div.html("");for(var i=0;i<s.length;i++){var n=s[i],o=n.bounds,a=n.id||"treemap-node-"+i,h=t("<div id="+a+"></div>");h.css(t.extend(o.style(),{position:"absolute","text-align":"center"})),this.setNodeColors(h,n),h.addClass("treemap-node");var r=t("<div class='overlay'></div>");e&&(r=t("<a href='#' class='overlay'></a>"));var c=this;r.bind("click",n,(function(t){return c.click(t.data,t),!1})),r.bind("mouseenter",n,(function(t){c.mouseenter(t.data,t)})),r.bind("mouseleave",n,(function(t){c.mouseleave(t.data,t)})),r.bind("mousemove",n,(function(t){c.mousemove(t.data,t)})),h.appendTo(this.$div),h.addClass(this.nodeClass(n,h,s.length));var l=t("<div>"+n.label+"</div>");l.addClass("treemap-item"),h.append(r),h.append(l),this.centerLabelVertically&&l.css("margin-top",parseInt(h.height())/2-parseInt(l.height())/2+"px")}this.ready()},i.prototype.fitLabelFontSize=function(t,e){var s=e.bounds;while(t.height()+i.TOP_MARGIN>s.height||t.width()+i.SIDE_MARGIN>s.width){var n=parseFloat(t.css("font-size"))-3;if(n<this.smallestFontSize){t.remove();break}t.css("font-size",n+"px")}t.css("display","block"),this.paintCallback(t,e)},i.HORIZONTAL=1,i.VERTICAL=2,i.prototype.squarify=function(t,e){return t.sort((function(t,e){return e.value-t.value})),this.divideDisplayArea(t,e),t},i.prototype.divideDisplayArea=function(t,e){if(0!==t.length)if(1!=t.length){var i=this.splitFairly(t),n=this.sumValues(i.left),o=this.sumValues(i.right),a=n+o;if(e.isWide()){var h=Math.round(n*e.width/a);this.divideDisplayArea(i.left,new s(e.x,e.y,h,e.height,this.itemMargin)),this.divideDisplayArea(i.right,new s(e.x+h,e.y,e.width-h,e.height,this.itemMargin))}else{h=Math.round(n*e.height/a);this.divideDisplayArea(i.left,new s(e.x,e.y,e.width,h,this.itemMargin)),this.divideDisplayArea(i.right,new s(e.x,e.y+h,e.width,e.height-h,this.itemMargin))}}else t[0].bounds=e},i.prototype.splitFairly=function(t){for(var e=this.sumValues(t)/2,s=0,i=t.length,n=0;n<i;n++){if(n>0&&s+t[n].value>e)break;s+=t[n].value}return{left:t.slice(0,n),right:t.slice(n)}},i.prototype.sumValues=function(t){for(var e=0,s=t.length,i=0;i<s;i++)e+=t[i].value;return e},t.fn.treemap=function(t,e){var s=this;return this.fadeOut(0,(function(){s.empty().fadeIn(0,(function(){new i(s,e).paint(t)}))}))}})(n())},8528:function(t,e,s){"use strict";s.r(e);var i=s(7626),n=s(7433),o=s.n(n);i.Quill.register("modules/htmlEditButton",o())},2372:function(t,e,s){s(4936),
/*!
 *
 * Selectable
 * Copyright (c) 2017 Karl Saunders (Mobius1)
 * Licensed under MIT (http://www.opensource.org/licenses/mit-license.php)
 *
 * Version: 0.22.0
 *
 */
function(e,s){var i="Selectable";t.exports=s(i)}("undefined"!==typeof s.g?s.g:this.window||this.global,(function(){"use strict";var t=function(t){return!!t.ctrlKey||!!t.metaKey},e=function(t){return!!t.shiftKey},s=["x","y"],i={x:"x1",y:"y1"},n={x:"x2",y:"y2"},o=function(t){this.version="0.22.0",this.v=this.version.split(".").map((function(t){return parseInt(t,10)})),this.touch="ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch,this.init(t)};function a(t,e){for(var s=[],i=0,n=e.length;i<n;i++){var o=e[i],a=Math.hypot(o.rect.x1-parseInt(t.clientX),o.rect.y1-parseInt(t.clientY));s.push(parseInt(a))}var h=s.indexOf(Math.min.apply(Math,s));return e[h].node}function h(t,e){return t&&t!==document.documentElement&&(e(t)?t:h(t.parentNode,e))}function r(t){return"[object Object]"===Object.prototype.toString.call(t)}function c(t){return Array.isArray(t)||t instanceof HTMLCollection||t instanceof NodeList}function l(t){return"isInteger"in Number?Number.isInteger(t):!isNaN(t)}function d(t,e){for(var s in e)if(e.hasOwnProperty(s)){var i=e[s];i&&r(i)?(t[s]=t[s]||{},d(t[s],i)):t[s]=i}return t}function u(t,e){var s=t.style;if(t){if(void 0===e)return window.getComputedStyle(t);if(r(e))for(var i in e)i in s||(i="-webkit-"+i),t.style[i]=e[i]+("string"==typeof e[i]||"opacity"===i?"":"px")}}function f(t){var e=window,s=t.getBoundingClientRect(),i=document.documentElement||document.body.parentNode||document.body,n=void 0!==e.pageXOffset?e.pageXOffset:i.scrollLeft,o=void 0!==e.pageYOffset?e.pageYOffset:i.scrollTop;return{x1:s.left+n,x2:s.left+s.width+n,y1:s.top+o,y2:s.top+s.height+o,height:s.height,width:s.width}}function g(t,e,s){var i;return function(){if(s=s||this,!i)return t.apply(s,arguments),i=!0,setTimeout((function(){i=!1}),e)}}function p(t){var e=0,s=0;do{e+=t.offsetTop||0,s+=t.offsetLeft||0,t=t.offsetParent}while(t);return{top:e,left:s}}function m(t,e,s,i,n){return n=n*Math.PI/180,{x:Math.cos(n)*(t-s)-Math.sin(n)*(e-i)+s,y:Math.sin(n)*(t-s)+Math.cos(n)*(e-i)+i}}function y(t,e){var s,i,n,o,a,h,r,c,l=[t,e];for(o=0;o<l.length;o++){var d=l[o];for(a=0;a<d.length;a++){var u=(a+1)%d.length,f=d[a],g=d[u],p=g.y-f.y,m=f.x-g.x;for(s=i=void 0,h=0;h<t.length;h++)n=p*t[h].x+m*t[h].y,(void 0===s||n<s)&&(s=n),(void 0===i||i<n)&&(i=n);for(r=c=void 0,h=0;h<e.length;h++)n=p*e[h].x+m*e[h].y,(void 0===r||n<r)&&(r=n),(void 0===c||c<n)&&(c=n);if(i<r||c<s)return!1}}return!0}return o.prototype={init:function(t){if(!this.initialised){var e={filter:".ui-selectable",tolerance:"touch",container:document.body,touch:!0,toggleTouch:!0,toggle:!1,autoRefresh:!0,throttle:50,lassoSelect:"normal",autoScroll:{threshold:0,increment:10},saveState:!1,ignore:!1,maxSelectable:!1,lasso:{border:"1px dotted #000",backgroundColor:"rgba(52, 152, 219, 0.2)"},keys:["shiftKey","ctrlKey","metaKey",""],classes:{lasso:"ui-lasso",handle:"ui-handle",selected:"ui-selected",container:"ui-container",selecting:"ui-selecting",selectable:"ui-selectable",deselecting:"ui-deselecting"}};this.config=d(e,t),this.origin={x:0,y:0},this.mouse={x:0,y:0};var s=this.config;this.autoscroll=r(s.autoScroll),this.lasso=!1,s.lasso&&r(s.lasso)&&(this.lasso=document.createElement("div"),this.lasso.className=s.classes.lasso,u(this.lasso,d({position:"absolute",boxSizing:"border-box",opacity:0},s.lasso))),this.touch&&(s.toggle=s.toggleTouch),s.touch||(this.touch=!1),this.callbacks={};for(var i=["_start","_touchstart","_drag","_end","_keyup","_keydown","_blur","_focus"],n=0,o=i.length;n<o;n++){var a=i[n];this.callbacks[a]=this[a].bind(this)}this.callbacks._refresh=g(this.refresh,s.throttle,this),this.autoscroll&&(this.callbacks._scroll=this._onScroll.bind(this)),this.setContainer(),this.scroll={x:this.bodyContainer?window.pageXOffset:this.container.scrollLeft,y:this.bodyContainer?window.pageYOffset:this.container.scrollTop},c(s.filter)?this.nodes=[].slice.call(s.filter):"string"===typeof s.filter&&(this.nodes=[].slice.call(this.container.querySelectorAll(s.filter))),this.hasHandle=!1!==s.handle&&"string"===typeof s.handle;for(n=0,o=this.nodes.length;n<o;n++){var h=this.nodes[n];if(h.classList.add(s.classes.selectable),this.hasHandle){var l=h.querySelectorAll(s.handle);if(l.length)for(var f=0,p=l.length;f<p;f++){var m=l[f];m.classList.add(s.classes.handle)}}}this.update(),this.enable();var y=this;setTimeout((function(){s.saveState&&y.state("save"),y.emit("init"),y.initialised=!0}),10)}},update:function(){this._loadItems(),this.refresh(),this.emit("update",this.items)},refresh:function(){var t=window.innerWidth,e=window.innerHeight,s=this.bodyContainer?window.pageXOffset:this.container.scrollLeft,i=this.bodyContainer?window.pageYOffset:this.container.scrollTop;this.offsetWidth=this.container.offsetWidth,this.offsetHeight=this.container.offsetHeight,this.clientWidth=this.container.clientWidth,this.clientHeight=this.container.clientHeight,this.scrollWidth=this.container.scrollWidth,this.scrollHeight=this.container.scrollHeight,this.boundingRect=f(this.container),this.bodyContainer&&(this.boundingRect.x2=t,this.boundingRect.y2=e),this.scroll={x:s,y:i,max:{x:this.scrollWidth-(this.bodyContainer?t:this.clientWidth),y:this.scrollHeight-(this.bodyContainer?e:this.clientHeight)},size:{x:this.clientWidth,y:this.clientHeight},scrollable:{x:this.scrollWidth>this.offsetWidth,y:this.scrollHeight>this.offsetHeight}};for(var n=0;n<this.nodes.length;n++)this.items[n].rect=f(this.nodes[n]);this.emit("refresh")},attachEvents:function(){var t=this.callbacks;this.detachEvents(),this.touch?(this.on(this.container,"touchstart",t._touchstart),this.on(document,"touchend",t._end),this.on(document,"touchcancel",t._end),!1!==this.lasso&&this.on(document,"touchmove",t._drag)):(this.on(this.container,"mousedown",t._start),this.on(document,"mouseup",t._end),this.on(document,"keydown",t._keydown),this.on(document,"keyup",t._keyup),this.on(this.container,"mouseenter",t._focus),this.on(this.container,"mouseover",t._focus),this.on(this.container,"mouseleave",t._blur),!1!==this.lasso&&this.on(document,"mousemove",t._drag)),this.autoscroll&&this.on(this.bodyContainer?window:this.container,"scroll",t._scroll),this.on(window,"resize",t._refresh),this.on(window,"scroll",t._refresh)},detachEvents:function(){var t=this.callbacks;this.off(this.container,"mousedown",t._start),this.off(document,"mousemove",t._drag),this.off(document,"mouseup",t._end),this.off(document,"keydown",t._keydown),this.off(document,"keyup",t._keyup),this.off(this.container,"mouseenter",t._focus),this.off(this.container,"mouseover",t._focus),this.off(this.container,"mouseleave",t._blur),this.autoscroll&&this.off(this.bodyContainer?window:this.container,"scroll",t._scroll),this.off(this.container,"touchstart",t._touchstart),this.off(document,"touchend",t._end),this.off(document,"touchcancel",t._end),this.off(document,"touchmove",t._drag),this.off(window,"resize",t._refresh),this.off(window,"scroll",t._refresh)},bind:function(){this.attachEvents()},unbind:function(){this.detachEvents()},setContainer:function(t){var e,s=this.config;if(this.container&&(e=this.container,this.detachEvents()),void 0===t&&(s.appendTo?(t=s.appendTo,s.container=s.appendTo):s.container&&(t=s.container)),"string"===typeof t?this.container=document.querySelector(t):t instanceof Element&&t.nodeName&&(this.container=t),this.container.classList.add(s.classes.container),this.container._selectable=this,e&&(e.classList.remove(s.classes.container),delete e._selectable),this.bodyContainer=this.container===document.body,this._loadItems(),this.autoscroll){var i=u(this.container);"static"!==i.position||this.bodyContainer||(this.container.style.position="relative")}this.attachEvents()},select:function(t,e,s){e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],s=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(c(t)){for(var i=this.getSelectedItems().length,n=0;n<t.length;n++){if(this.config.maxSelectable&&i>=this.config.maxSelectable)break;this.select(t[n],!1,!1),i++}return s&&this.config.saveState&&this.state("save"),this.getSelectedItems()}if(t=this.get(t),t){if(this.config.toggle&&"drag"===this.config.toggle&&!e&&t.selected&&!this.cmdDown)return this.deselect(t,!1);var o=t.node,a=this.config.classes;return o.classList.remove(a.selecting),o.classList.add(a.selected),t.selecting=!1,t.selected=!0,t.startselected=!0,s&&this.config.saveState&&this.state("save"),this.emit("select",t),t}return!1},deselect:function(t,e){if(c(t)){for(var s=0;s<t.length;s++)this.deselect(t[s],!1);return e&&this.config.saveState&&this.state("save"),this.getSelectedItems()}if(t=this.get(t),t){var i=t.node,n=this.config.classes;return t.selecting=!1,t.selected=!1,t.deselecting=!1,t.startselected=!1,i.classList.remove(n.deselecting),i.classList.remove(n.selecting),i.classList.remove(n.selected),e&&this.config.saveState&&this.state("save"),this.emit("deselect",t),t}return!1},toggle:function(t,e){if(void 0===t)return this.invert();var s=this.get(t);if(s){this._isCollection(s)||(s=[s]);for(var i=0,n=s.length;i<n;i++){var o=s[i];void 0!==e?e?this.select(o,!1,!1):this.deselect(o,!1):o.selected?this.deselect(o,!1):this.select(o,!1,!1)}this.config.saveState&&this.state("save")}},add:function(t){var e=[];"string"===typeof t&&(t=[].slice.call(this.container.querySelectorAll(t))),c(t)||(t=[t]);for(var s=0,i=t.length;s<i;s++){var n=t[s];if(this.nodes.indexOf(n)<0&&n instanceof Element&&(e.push(n),n.classList.add(this.config.classes.selectable),this.hasHandle)){var o=n.querySelectorAll(this.config.handle);if(o.length>0)for(var a=0,h=o.length;a<h;a++){var r=o[a];r.classList.add(this.config.classes.handle)}}}this.nodes=this.nodes.concat(e),this.update();for(s=0;s<e.length;s++)this.emit("add",this.get(e[s]))},remove:function(t,e){if(t=this.get(t),t){if(c(t))for(var s=t.length-1;s>=0;s--)this.remove(t[s],s>0);else{var i=t.node,n=this.config.classes;if(i.classList.remove(n.selectable),i.classList.remove(n.deselecting),i.classList.remove(n.selecting),i.classList.remove(n.selected),this.hasHandle){const t=i.querySelectorAll(this.config.handle);if(t.length){s=0;for(var o=t.length;s<o;s++){var a=t[s];a.classList.remove(n.handle)}}}this.nodes.splice(this.nodes.indexOf(t.node),1),this.emit("remove",t)}return e||this.update(),!0}return!1},selectAll:function(){var t=this.items.length;this.config.maxSelectable&&this.config.maxSelectable<t&&(t=this.config.maxSelectable);for(var e=0;e<t;e++)this.select(this.items[e],!0,!1);this.config.saveState&&this.state("save")},invert:function(){var t=this.getItems();if(this.config.maxSelectable&&this.config.maxSelectable<t.length)return this._maxReached();for(var e=0;e<this.items.length;e++){var s=this.items[e];s.selected?this.deselect(s,!1):this.select(s,!1,!1)}this.config.saveState&&this.state("save")},clear:function(t){t=!(arguments.length>0&&void 0!==arguments[0]);for(var e=this.items.length-1;e>=0;e--)this.deselect(this.items[e],!1);t&&this.config.saveState&&this.state("save")},get:function(t){var e=!1;if("string"===typeof t&&(t=[].slice.call(this.container.querySelectorAll(t))),c(t)){e=[];for(var s=0;s<t.length;s++){var i=this.get(t[s]);i&&e.push(i)}}else isNaN(t)?t instanceof Element?e=this.items[this.nodes.indexOf(t)]:r(t)&&this.items.indexOf(t)>=0&&(e=t):this.items.indexOf(this.items[t])>=0&&(e=this.items[t]);return e},getItems:function(){return this.items},getNodes:function(){return this.nodes},getFirstSelectedItem(){return this.getSelectedItems()[0]},getFirstSelectedNode(){return this.getSelectedNodes()[0]},getSelectedItems:function(t){return this.getItems().filter((function(e){return t?!e.selected:e.selected}))},getUnSelectedItems:function(t){return this.getItems().filter((function(t){return!t.selected}))},getSelectedNodes:function(){return this.getSelectedItems().map((function(t){return t.node}))},getUnSelectedNodes:function(){return this.getUnSelectedItems().map((function(t){return t.node}))},state:function(t){var e=!1,s=!1;switch(t){case"save":this.states=this.states||[],this.states.push(this.getSelectedNodes()),l(this.config.saveState)&&this.states.length>this.config.saveState&&this.states.shift(),this.currentState=this.states.length-1,s=!0;break;case"undo":this.currentState>0&&(this.currentState--,e=!0,s=!0);break;case"redo":this.currentState<this.states.length-1&&(this.currentState++,e=!0,s=!0);break;case"clear":this.states=[],this.currentState=!1;break}e&&(this.clear(!1),this.select(this.states[this.currentState],!1,!1)),s&&this.emit("state."+t,this.states[this.currentState],this.states)},undo:function(){this.state("undo")},redo:function(){this.state("redo")},enable:function(){if(!this.enabled){var t=this.config.keys;this.enabled=!0,this.canShift=t.indexOf("shiftKey")>=0,this.canCtrl=t.indexOf("ctrlKey")>=0,this.canMeta=t.indexOf("metaKey")>=0,this.attachEvents(),this.container.classList.add(this.config.classes.container),this.emit("enable")}return this.enabled},disable:function(){if(this.enabled){this.config.keys;this.enabled=!1,this.detachEvents(),this.container.classList.remove(this.config.classes.container),this.emit("disabled")}return this.enabled},destroy:function(){this.initialised&&(this.disable(),this.emit("destroyed"),this.listeners=!1,this.clear(),this.state("clear"),this.remove(this.items),this.callbacks=null,this.initialised=!1)},on:function(t,e,s){"string"===typeof t?(this.listeners=this.listeners||{},this.listeners[t]=this.listeners[t]||[],this.listeners[t].push({callback:e,once:!1})):arguments[0].addEventListener(arguments[1],arguments[2],!1)},once:function(t,e,s){"string"===typeof t?(this.listeners=this.listeners||{},this.listeners[t]=this.listeners[t]||[],this.listeners[t].push({callback:e,once:!0})):arguments[0].addEventListener(arguments[1],arguments[2],!1)},off:function(t,e){if("string"===typeof t){if(this.listeners=this.listeners||{},t in this.listeners===!1)return;for(var s=0,i=this.listeners[t].length;s<i;s++)this.listeners[t][s].callback===e&&this.listeners[t].splice(s,1)}else arguments[0].removeEventListener(arguments[1],arguments[2])},emit:function(t){if(this.listeners=this.listeners||{},t in this.listeners!==!1)for(var e=0,s=this.listeners[t].length;e<s;e++)this.listeners[t][e].callback.apply(this,Array.prototype.slice.call(arguments,1)),this.listeners[t][e].once&&this.off(t,this.listeners[t][e].callback)},_maxReached:function(){return this.emit("maxitems")},_touchstart:function(t){this.off(this.container,"mousedown",this.callbacks.start),this._start(t)},_start:function(s){var i,n=this,o=this._getEvent(s),r=this.config,c=t(s)&&(this.canCtrl||this.canMeta),l=this.canShift&&e(s),d=this.getSelectedItems().length,u=r.maxSelectable;if(u&&d>=u&&(c||l))return this._maxReached();if(!(!this.container.contains(s.target)||3===s.which||s.button>0||r.disabled)){if(this.scroll.scrollable.y&&o.pageX>this.boundingRect.x1+this.scroll.size.x||this.scroll.scrollable.x&&o.pageY>this.boundingRect.y1+this.scroll.size.y)return!1;if(this.config.ignore){var f=!1,g=this.config.ignore;Array.isArray(g)||(g=[g]);for(var p=0;p<g.length;p++){var m=s.target.closest(g[p]);if(m){f=!0;break}}if(f)return!1}if(this.hasHandle&&!s.target.classList.contains(r.classes.handle))return!1;var y=h(s.target,(function(t){return t===n.container||t.classList.contains(r.classes.selectable)}));if(!y)return!1;if(-1===["INPUT","SELECT","BUTTON","TEXTAREA","OPTION"].indexOf(s.target.tagName)&&s.preventDefault(),this.dragging=!0,this.origin={x:o.pageX+(this.bodyContainer?0:this.scroll.x),y:o.pageY+(this.bodyContainer?0:this.scroll.y),scroll:{x:this.scroll.x,y:this.scroll.y}},this.lasso&&this.container.appendChild(this.lasso),y!==this.container){var v=this.get(y);v.selecting=!0,y.classList.add(r.classes.selecting),this.emit("selecting",o,v)}else"sequential"==r.lassoSelect&&(y=a(o,this.items));if(r.autoRefresh&&this.refresh(),l&&this.startEl&&y!==this.container){var b=this.getItems(),_=this.getNodes().indexOf(y),w=this.getNodes().indexOf(this.getFirstSelectedNode());if(_>w)for(p=w+1;p<_;p++)b[p].selecting=!0,this.emit("selecting",o,b[p]);else for(p=w-1;p>_;p--)b[p].selecting=!0,this.emit("selecting",o,b[p])}for(p=0;p<this.items.length;p++){v=this.items[p];var x=v.node,S=x===y;if(v.selected){v.startselected=!0;var k=r.toggle||c?S:!S&&!l;k&&(x.classList.remove(r.classes.selected),v.selected=!1,x.classList.add(r.classes.deselecting),v.deselecting=!0,this.emit("deselecting",o,v))}S&&(i=v)}this.startEl=y,this.emit("start",s,i)}},_drag:function(e){var o=this.config;if(!o.disabled&&this.dragging&&this.canShift){var a,h=this._getEvent(e);t(e)&&(this.canCtrl||this.canMeta);this.mouse={x:h.pageX,y:h.pageY},this.current={x1:this.origin.x,y1:this.origin.y,x2:this.mouse.x+(this.bodyContainer?0:this.scroll.x),y2:this.mouse.y+(this.bodyContainer?0:this.scroll.y)};for(var r=0;r<s.length;r++){var c=s[r];this.current[i[c]]>this.current[n[c]]&&(a=this.current[n[c]],this.current[n[c]]=this.current[i[c]],this.current[i[c]]=a)}if(this.coords={x1:this.current.x1,x2:this.current.x2-this.current.x1,y1:this.current.y1,y2:this.current.y2-this.current.y1},"normal"===o.lassoSelect)for(r=0;r<this.items.length;r++)this._highlight(this.items[r],t(e)&&(this.canCtrl||this.canMeta),h);else"sequential"===o.lassoSelect&&this._sequentialSelect(h);this.autoscroll&&(this.bodyContainer||(this.coords.x1-=this.boundingRect.x1,this.coords.y1-=this.boundingRect.y1),this._autoScroll()),this.lasso&&(this.bodyContainer||!this.autoscroll||this.config.autoScroll.lassoOverflow||this._limitLasso(),u(this.lasso,{left:this.coords.x1,top:this.coords.y1,width:this.coords.x2,height:this.coords.y2,opacity:1})),this.emit("drag",e,this.coords)}},_end:function(t){if(this.dragging){this.dragging=!1;var e,s=this,i=s.config,n=t.target,o=this._getEvent(t),a=[],r=[],c=this.getSelectedItems().length,l=i.maxSelectable;this.lasso&&this.container.contains(this.lasso)&&this.container.removeChild(this.lasso),this.lasso&&(u(this.lasso,{opacity:0,left:0,width:0,top:0,height:0}),n=document.elementFromPoint(o.pageX,o.pageY),n||(n=this.container)),e=h(n,(function(t){return t.classList.contains(i.classes.selectable)}));for(var d=!1,f=0;f<this.items.length;f++){var g=this.items[f];i.toggle&&g.node===e&&g.node===this.startEl&&g.selecting&&g.startselected&&(g.deselecting=!0,g.selecting=!1,this.emit("deselecting",o,g)),g.deselecting&&(r.push(g),this.deselect(g,!1)),g.selecting&&(l&&c+a.length>=l?(g.selecting=!1,g.node.classList.remove(i.classes.selecting),d=!0):(a.push(g),this.select(g,!1,!1)))}return i.saveState&&this.state("save"),this.emit("end",t,a,r),d?this._maxReached():void 0}},_keydown:function(e){this.cmdDown=t(e)&&(this.canCtrl||this.canMeta);var s=!1;if(void 0!==e.key?s=e.key:void 0!==e.keyCode&&(s=e.keyCode),s)if(this.cmdDown&&this.focused)switch(s){case 65:case"a":case"A":e.preventDefault(),this.selectAll();break;case 89:case"y":case"Y":this.state("redo");break;case 90:case"z":case"Z":this.state("undo");break}else switch(s){case 32:case" ":this.toggle(document.activeElement);break}},_keyup:function(e){this.cmdDown=t(e)&&(this.canCtrl||this.canMeta)},_onScroll:function(t){this.scroll.x=this.bodyContainer?window.pageXOffset:this.container.scrollLeft,this.scroll.y=this.bodyContainer?window.pageYOffset:this.container.scrollTop;for(var e=0;e<this.items.length;e++)this.items[e].rect=f(this.items[e].node)},_loadItems:function(){var t=this.config;if(this.nodes=[].slice.call(this.container.querySelectorAll("."+t.classes.selectable)),this.items=[],this.nodes.length)for(var e=0;e<this.nodes.length;e++){var s=this.nodes[e];s.classList.add(t.classes.selectable);var i={node:s,rect:f(s),startselected:!1,selected:s.classList.contains(t.classes.selected),selecting:s.classList.contains(t.classes.selecting),deselecting:s.classList.contains(t.classes.deselecting)},n=this._get2DTransformation(s);if(n){for(var o=p(s),a=n.translate,h=n.origin,r=n.scale,c=s.offsetWidth,l=s.offsetHeight,d=o.left,u=o.top,g=h.x,y=h.y,v=c/2,b=l/2,_=d+(v-g)*r+g,w=u+(b-y)*r+y,x=v*r,S=b*r,k=[{x:_-x,y:w-S},{x:_+x,y:w-S},{x:_+x,y:w+S},{x:_-x,y:w+S}],C=0;C<=3;C++)k[C]=m(k[C].x+a.x,k[C].y+a.y,d+g+a.x,u+y+a.y,n.angle);i.transform={rect:k}}this.items.push(i)}},_getEvent:function(t){return this.touch?"touchend"===t.type?t.changedTouches[0]:t.touches[0]:t},_autoScroll:function(){var t=this.config.autoScroll,e=t.increment,o=t.threshold,a={x:0,y:0};this.bodyContainer&&(this.mouse.x-=this.scroll.x,this.mouse.y-=this.scroll.y);for(var h=0;h<s.length;h++){var r=s[h];this.mouse[r]>=this.boundingRect[n[r]]-o&&this.scroll[r]<this.scroll.max[r]?a[r]=e:this.mouse[r]<=this.boundingRect[i[r]]+o&&this.scroll[r]>0&&(a[r]=-e)}this.bodyContainer?window.scrollBy(a.x,a.y):(this.container.scrollTop+=a.y,this.container.scrollLeft+=a.x)},_limitLasso:function(){for(var t=0;t<s.length;t++){var e=s[t],o=this.boundingRect[i[e]]+this.scroll.size[e];if(this.mouse[e]>=o&&this.scroll[e]>=this.scroll.max[e]){var a=this.origin[e]-this.boundingRect[i[e]]-this.scroll[e];this.coords[i[e]]=this.origin[e]-this.boundingRect[i[e]],this.coords[n[e]]=o-a-this.boundingRect[i[e]]}this.mouse[e]<=this.boundingRect[i[e]]&&this.scroll[e]<=0&&(this.coords[i[e]]=0,this.coords[n[e]]=this.origin[e]-this.boundingRect[i[e]])}},_sequentialSelect:function(e){var s,i,n=this.config.classes,o=document.elementFromPoint(e.pageX,e.pageY-window.pageYOffset);if(o&&(o=o.closest("."+n.selectable),o)){this.mouse.y>this.origin.y?(s=this.nodes.indexOf(this.startEl),i=this.nodes.indexOf(o)):this.mouse.y<this.origin.y&&(s=this.nodes.indexOf(o),i=this.nodes.indexOf(this.startEl));for(var a=0;a<this.items.length;a++){var h=this.items[a];a>=s&&a<=i?this._highlight(h,t(e)&&(this.canCtrl||this.canMeta)):(h.selecting=!1,h.node.classList.remove(n.selecting))}}},_highlight:function(t,e,s){var i=this.config,n=t.node,o=!1,a=this.bodyContainer?0:this.scroll.x,h=this.bodyContainer?0:this.scroll.y;if("normal"===i.lassoSelect)if("touch"===i.tolerance)if(t.transform){var r=[{x:this.origin.x,y:this.origin.y},{x:this.mouse.x+a,y:this.origin.y},{x:this.mouse.x+a,y:this.mouse.y+h},{x:this.origin.x,y:this.mouse.y+h}];o=y(r,t.transform.rect)}else o=!(t.rect.x1+a>this.current.x2||t.rect.x2+a<this.current.x1||t.rect.y1+h>this.current.y2||t.rect.y2+h<this.current.y1);else"fit"===i.tolerance&&(o=t.rect.x1+a>this.current.x1&&t.rect.x2+a<this.current.x2&&t.rect.y1+h>this.current.y1&&t.rect.y2+h<this.current.y2);else o=!0;o?(t.selected&&!i.toggle&&(n.classList.remove(i.classes.selected),t.selected=!1),t.deselecting&&(!i.toggle||i.toggle&&"drag"!==i.toggle)&&(n.classList.remove(i.classes.deselecting),t.deselecting=!1),t.selecting||(n.classList.add(i.classes.selecting),t.selecting=!0,this.emit("selecting",s,t))):(t.selecting&&(n.classList.remove(i.classes.selecting),t.selecting=!1,e&&t.startselected?(n.classList.add(i.classes.selected),t.selected=!0):t.startselected&&!i.toggle&&(n.classList.add(i.classes.deselecting),t.deselecting=!0,this.emit("deselecting",s,t))),t.selected&&(e||t.startselected||(n.classList.remove(i.classes.selected),t.selected=!1,n.classList.add(i.classes.deselecting),t.deselecting=!0,this.emit("deselecting",s,t))))},_focus:function(t){this.focused=!0,this.container.classList.add("ui-focused")},_blur:function(t){this.focused=!1,this.container.classList.remove("ui-focused")},_get2DTransformation:function(t){var e=window.getComputedStyle(t,null),s=e.getPropertyValue("-webkit-transform")||e.getPropertyValue("-moz-transform")||e.getPropertyValue("-ms-transform")||e.getPropertyValue("-o-transform")||e.getPropertyValue("transform")||!1;if(s&&"none"!==s){var i=s.split("(")[1].split(")")[0].split(", "),n=parseFloat(i[0]),o=parseFloat(i[1]),a=Math.sqrt(n*n+o*o),h=e.transformOrigin.split(" ").map((function(t){return parseFloat(t)}));return{angle:Math.round(Math.atan2(o,n)*(180/Math.PI)),scale:a,origin:{x:parseFloat(h[0]),y:parseFloat(h[1])},translate:{x:parseFloat(i[4]),y:parseFloat(i[5])}}}return!1}},o}))}}]);